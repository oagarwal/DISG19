<!DOCTYPE html>

<html>
<head>
  <title>twitter.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="parser.html">
                parser.js
              </a>
            
              
              <a class="source" href="twitter.html">
                twitter.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>twitter.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span>	VERSION = <span class="string">'0.1.18'</span>,
	http = require(<span class="string">'http'</span>),
	querystring = require(<span class="string">'querystring'</span>),
	oauth = require(<span class="string">'oauth'</span>),
	Cookies = require(<span class="string">'cookies'</span>),
	Keygrip = require(<span class="string">'keygrip'</span>),
	streamparser = require(<span class="string">'./parser'</span>);

<span class="function"><span class="keyword">function</span> <span class="title">merge</span><span class="params">(defaults, options)</span> {</span>
	defaults = defaults || {};
	<span class="keyword">if</span> (options &amp;&amp; <span class="keyword">typeof</span> options === <span class="string">'object'</span>) {
		<span class="keyword">var</span> keys = Object.keys(options);
		<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = keys.length; i &lt; len; i++) {
			<span class="keyword">var</span> k = keys[i];
			<span class="keyword">if</span> (options[k] !== <span class="literal">undefined</span>) defaults[k] = options[k];
		}
	}
	<span class="keyword">return</span> defaults;
}


<span class="function"><span class="keyword">function</span> <span class="title">Twitter</span><span class="params">(options)</span> {</span>
	<span class="keyword">if</span> (!(<span class="keyword">this</span> <span class="keyword">instanceof</span> Twitter)) <span class="keyword">return</span> <span class="keyword">new</span> Twitter(options);

	<span class="keyword">var</span> defaults = {
		consumer_key: <span class="literal">null</span>,
		consumer_secret: <span class="literal">null</span>,
		access_token_key: <span class="literal">null</span>,
		access_token_secret: <span class="literal">null</span>,

		headers: {
			<span class="string">'Accept'</span>: <span class="string">'*/*'</span>,
			<span class="string">'Connection'</span>: <span class="string">'close'</span>,
			<span class="string">'User-Agent'</span>: <span class="string">'node-twitter/'</span> + VERSION
		},

		request_token_url: <span class="string">'https://api.twitter.com/oauth/request_token'</span>,
		access_token_url: <span class="string">'https://api.twitter.com/oauth/access_token'</span>,
		authenticate_url: <span class="string">'https://api.twitter.com/oauth/authenticate'</span>,
		authorize_url: <span class="string">'https://api.twitter.com/oauth/authorize'</span>,
		callback_url: <span class="literal">null</span>,

		rest_base: <span class="string">'https://api.twitter.com/1.1'</span>,
    stream_base: <span class="string">'https://stream.twitter.com/1.1'</span>,
    search_base: <span class="string">'https://api.twitter.com/1.1/search'</span>,
    user_stream_base: <span class="string">'https://userstream.twitter.com/1.1'</span>,
    site_stream_base: <span class="string">'https://sitestream.twitter.com/1.1'</span>,

		secure: <span class="literal">false</span>, <span class="comment">// force use of https for login/gatekeeper</span>
		cookie: <span class="string">'twauth'</span>,
		cookie_options: {},
		cookie_secret: <span class="literal">null</span>
	};
	<span class="keyword">this</span>.options = merge(defaults, options);

	<span class="keyword">this</span>.keygrip = <span class="keyword">this</span>.options.cookie_secret === <span class="literal">null</span> ? <span class="literal">null</span> :
		<span class="keyword">new</span> Keygrip([<span class="keyword">this</span>.options.cookie_secret]);

	<span class="keyword">this</span>.oauth = <span class="keyword">new</span> oauth.OAuth(
		<span class="keyword">this</span>.options.request_token_url,
		<span class="keyword">this</span>.options.access_token_url,
		<span class="keyword">this</span>.options.consumer_key,
		<span class="keyword">this</span>.options.consumer_secret,
		<span class="string">'1.0A'</span>,
		<span class="keyword">this</span>.options.callback_url,
		<span class="string">'HMAC-SHA1'</span>, <span class="literal">null</span>,
		<span class="keyword">this</span>.options.headers);
}
Twitter.VERSION = VERSION;
module.exports = Twitter;


<span class="comment">/*
 * GET
 */</span>
Twitter.prototype.get = <span class="function"><span class="keyword">function</span><span class="params">(url, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">if</span> ( <span class="keyword">typeof</span> callback !== <span class="string">'function'</span> ) {
		<span class="keyword">throw</span> <span class="string">"FAIL: INVALID CALLBACK."</span>;
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}

	<span class="keyword">if</span> (url.charAt(<span class="number">0</span>) == <span class="string">'/'</span>)
		url = <span class="keyword">this</span>.options.rest_base + url;

	<span class="keyword">this</span>.oauth.get(url + <span class="string">'?'</span> + querystring.stringify(params),
		<span class="keyword">this</span>.options.access_token_key,
		<span class="keyword">this</span>.options.access_token_secret,
	<span class="function"><span class="keyword">function</span><span class="params">(error, data, response)</span> {</span>
		<span class="keyword">if</span> (error) {
			<span class="keyword">var</span> err = <span class="keyword">new</span> Error(<span class="string">'HTTP Error '</span>
				+ error.statusCode + <span class="string">': '</span>
				+ http.STATUS_CODES[error.statusCode]);
			err.statusCode = error.statusCode;
			err.data = error.data;
			callback(err);
		} <span class="keyword">else</span> {
			<span class="keyword">try</span> {
				<span class="keyword">var</span> json = JSON.parse(data);
				callback(json);
			} <span class="keyword">catch</span>(err) {
				callback(err);
			}
		}
	});
	<span class="keyword">return</span> <span class="keyword">this</span>;
}


<span class="comment">/*
 * POST
 */</span>
Twitter.prototype.post = <span class="function"><span class="keyword">function</span><span class="params">(url, content, content_type, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> content === <span class="string">'function'</span>) {
		callback = content;
		content = <span class="literal">null</span>;
		content_type = <span class="literal">null</span>;
	} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> content_type === <span class="string">'function'</span>) {
		callback = content_type;
		content_type = <span class="literal">null</span>;
	}

	<span class="keyword">if</span> ( <span class="keyword">typeof</span> callback !== <span class="string">'function'</span> ) {
		<span class="keyword">throw</span> <span class="string">"FAIL: INVALID CALLBACK."</span>;
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}

	<span class="keyword">if</span> (url.charAt(<span class="number">0</span>) == <span class="string">'/'</span>)
		url = <span class="keyword">this</span>.options.rest_base + url;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Workaround: oauth + booleans == broken signatures</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (content &amp;&amp; <span class="keyword">typeof</span> content === <span class="string">'object'</span>) {
		Object.keys(content).forEach(<span class="function"><span class="keyword">function</span><span class="params">(e)</span> {</span>
			<span class="keyword">if</span> ( <span class="keyword">typeof</span> content[e] === <span class="string">'boolean'</span> )
				content[e] = content[e].toString();
		});
	}

	<span class="keyword">this</span>.oauth.post(url,
		<span class="keyword">this</span>.options.access_token_key,
		<span class="keyword">this</span>.options.access_token_secret,
		content, content_type,
	<span class="function"><span class="keyword">function</span><span class="params">(error, data, response)</span> {</span>
		<span class="keyword">if</span> (error) {
			<span class="keyword">var</span> err = <span class="keyword">new</span> Error(<span class="string">'HTTP Error '</span>
				+ error.statusCode + <span class="string">': '</span>
				+ http.STATUS_CODES[error.statusCode]);
			err.statusCode = error.statusCode;
			err.data = error.data;
			callback(err);
		} <span class="keyword">else</span> {
			<span class="keyword">try</span> {
				<span class="keyword">var</span> json = JSON.parse(data);
				callback(json);
			} <span class="keyword">catch</span>(err) {
				callback(err);
			}
		}
	});
	<span class="keyword">return</span> <span class="keyword">this</span>;
}


<span class="comment">/*
 * SEARCH (not API stable!)
 */</span>
Twitter.prototype.search = <span class="function"><span class="keyword">function</span><span class="params">(q, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">if</span> ( <span class="keyword">typeof</span> callback !== <span class="string">'function'</span> ) {
		<span class="keyword">throw</span> <span class="string">"FAIL: INVALID CALLBACK."</span>;
		<span class="keyword">return</span> <span class="keyword">this</span>;
	}

	<span class="keyword">var</span> url = <span class="keyword">this</span>.options.search_base + <span class="string">'/tweets.json'</span>;
	params = merge(params, {q:q});
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}


<span class="comment">/*
 * STREAM
 */</span>
Twitter.prototype.stream = <span class="function"><span class="keyword">function</span><span class="params">(method, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> stream_base = <span class="keyword">this</span>.options.stream_base;</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Stream type customisations</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (method === <span class="string">'user'</span>) {
		stream_base = <span class="keyword">this</span>.options.user_stream_base;</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Workaround for node-oauth vs. twitter commas-in-params bug</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> ( params &amp;&amp; params.track &amp;&amp; Array.isArray(params.track) ) {
			params.track = params.track.join(<span class="string">','</span>)
		}

	} <span class="keyword">else</span> <span class="keyword">if</span> (method === <span class="string">'site'</span>) {
		stream_base = <span class="keyword">this</span>.options.site_stream_base;</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Workaround for node-oauth vs. twitter double-encode-commas bug</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> ( params &amp;&amp; params.follow &amp;&amp; Array.isArray(params.follow) ) {
			params.follow = params.follow.join(<span class="string">','</span>)
		}
	}


	<span class="keyword">var</span> url = stream_base + <span class="string">'/'</span> + escape(method) + <span class="string">'.json'</span>;

	<span class="keyword">var</span> request = <span class="keyword">this</span>.oauth.post(url,
		<span class="keyword">this</span>.options.access_token_key,
		<span class="keyword">this</span>.options.access_token_secret,
		params);

	<span class="keyword">var</span> stream = <span class="keyword">new</span> streamparser();
	stream.destroy = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>FIXME: should we emit end/close on explicit destroy?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> ( <span class="keyword">typeof</span> request.abort === <span class="string">'function'</span> )
			request.abort(); <span class="comment">// node v0.4.0</span>
		<span class="keyword">else</span>
			request.socket.destroy();
	};

	request.on(<span class="string">'response'</span>, <span class="function"><span class="keyword">function</span><span class="params">(response)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>FIXME: Somehow provide chunks of the response when the stream is connected
Pass HTTP response data to the parser, which raises events on the stream</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		response.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span><span class="params">(chunk)</span> {</span>
			stream.receive(chunk);
		});
		response.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span><span class="params">(error)</span> {</span>
			stream.emit(<span class="string">'error'</span>, error);
		});
		response.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
			stream.emit(<span class="string">'end'</span>, response);
		});
	});
	request.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span><span class="params">(error)</span> {</span>
		stream.emit(<span class="string">'error'</span>, error);
	});
	request.end();

	<span class="keyword">if</span> ( <span class="keyword">typeof</span> callback === <span class="string">'function'</span> ) callback(stream);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}


<span class="comment">/*
 * TWITTER "O"AUTHENTICATION UTILITIES, INCLUDING THE GREAT
 * CONNECT/STACK STYLE TWITTER "O"AUTHENTICATION MIDDLEWARE
 * and helpful utilities to retrieve the twauth cookie etc.
 */</span>
Twitter.prototype.cookie = <span class="function"><span class="keyword">function</span><span class="params">(req)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Fetch the cookie</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span> cookies = <span class="keyword">new</span> Cookies(req, <span class="literal">null</span>, <span class="keyword">this</span>.keygrip);
	<span class="keyword">return</span> <span class="keyword">this</span>._readCookie(cookies);
}

Twitter.prototype.login = <span class="function"><span class="keyword">function</span><span class="params">(mount, success)</span> {</span>
	<span class="keyword">var</span> self = <span class="keyword">this</span>,
		url = require(<span class="string">'url'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Save the mount point for use in gatekeeper</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">this</span>.options.login_mount = mount = mount || <span class="string">'/twauth'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Use secure cookie if forced to https and haven&#39;t configured otherwise</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> ( <span class="keyword">this</span>.options.secure &amp;&amp; !<span class="keyword">this</span>.options.cookie_options.secure )
		<span class="keyword">this</span>.options.cookie_options.secure = <span class="literal">true</span>;

	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span><span class="params">(req, res, next)</span> {</span>
		<span class="keyword">var</span> path = url.parse(req.url, <span class="literal">true</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>We only care about requests against the exact mount point</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> ( path.pathname !== mount ) <span class="keyword">return</span> next();</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Set the oauth_callback based on this request if we don&#39;t have it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> ( !self.oauth._authorize_callback ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>have to get the entire url because this is an external callback
but it&#39;s only done once...</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">var</span> scheme = (req.socket.secure || self.options.secure) ? <span class="string">'https://'</span> : <span class="string">'http://'</span>,
				path = url.parse(scheme + req.headers.host + req.url, <span class="literal">true</span>);
			self.oauth._authorize_callback = path.href;
		}</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Fetch the cookie</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">var</span> cookies = <span class="keyword">new</span> Cookies(req, res, self.keygrip);
		<span class="keyword">var</span> twauth = self._readCookie(cookies);</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>We have a winner, but they&#39;re in the wrong place</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> ( twauth &amp;&amp; twauth.user_id &amp;&amp; twauth.access_token_secret ) {
			res.writeHead(<span class="number">302</span>, {<span class="string">'Location'</span>: success || <span class="string">'/'</span>});
			res.end();
			<span class="keyword">return</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Returning from Twitter with oauth_token</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="keyword">else</span> <span class="keyword">if</span> ( path.query &amp;&amp; path.query.oauth_token &amp;&amp; path.query.oauth_verifier &amp;&amp; twauth &amp;&amp; twauth.oauth_token_secret ) {
			self.oauth.getOAuthAccessToken(
				path.query.oauth_token,
				twauth.oauth_token_secret,
				path.query.oauth_verifier,
			<span class="function"><span class="keyword">function</span><span class="params">(error, access_token_key, access_token_secret, params)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>FIXME: if we didn&#39;t get these, explode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="keyword">var</span> user_id = (params &amp;&amp; params.user_id) || <span class="literal">null</span>,
					screen_name = (params &amp;&amp; params.screen_name) || <span class="literal">null</span>;

				<span class="keyword">if</span> ( error ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>FIXME: do something more intelligent</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="keyword">return</span> next(<span class="number">500</span>);
				} <span class="keyword">else</span> {
					cookies.set(self.options.cookie, JSON.stringify({
						user_id: user_id,
						screen_name: screen_name,
						access_token_key: access_token_key,
						access_token_secret: access_token_secret
					}), self.options.cookie_options);
					res.writeHead(<span class="number">302</span>, {<span class="string">'Location'</span>: success || <span class="string">'/'</span>});
					res.end();
					<span class="keyword">return</span>;
				}
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Begin OAuth transaction if we have no cookie or access_token_secret</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="keyword">else</span> <span class="keyword">if</span> ( !(twauth &amp;&amp; twauth.access_token_secret) ) {
			self.oauth.getOAuthRequestToken(
			<span class="function"><span class="keyword">function</span><span class="params">(error, oauth_token, oauth_token_secret, oauth_authorize_url, params)</span> {</span>
				<span class="keyword">if</span> ( error ) {</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>FIXME: do something more intelligent</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="keyword">return</span> next(<span class="number">500</span>);
				} <span class="keyword">else</span> {
					cookies.set(self.options.cookie, JSON.stringify({
						oauth_token: oauth_token,
						oauth_token_secret: oauth_token_secret
					}), self.options.cookie_options);
					res.writeHead(<span class="number">302</span>, {
						<span class="string">'Location'</span>: self.options.authorize_url + <span class="string">'?'</span>
							+ querystring.stringify({oauth_token: oauth_token})
					});
					res.end();
					<span class="keyword">return</span>;
				}
			});</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Broken cookie, clear it and return to originating page
FIXME: this is dumb</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		} <span class="keyword">else</span> {
			cookies.set(self.options.cookie, <span class="literal">null</span>, self.options.cookie_options);
			res.writeHead(<span class="number">302</span>, {<span class="string">'Location'</span>: mount});
			res.end();
			<span class="keyword">return</span>;
		}
	};
}

Twitter.prototype.gatekeeper = <span class="function"><span class="keyword">function</span><span class="params">(failure)</span> {</span>
	<span class="keyword">var</span> self = <span class="keyword">this</span>,
		mount = <span class="keyword">this</span>.options.login_mount || <span class="string">'/twauth'</span>;

	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(req, res, next)</span> {</span>
		<span class="keyword">var</span> twauth = self.cookie(req);</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>We have a winner</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> ( twauth &amp;&amp; twauth.user_id &amp;&amp; twauth.access_token_secret )
			<span class="keyword">return</span> next();</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>I pity the fool!
FIXME: use &#39;failure&#39; param to fail with: a) 401, b) redirect
       possibly using configured login mount point
       perhaps login can save the mount point, then we can use it?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		res.writeHead(<span class="number">401</span>, {}); <span class="comment">// {} for bug in stack</span>
		res.end([
			<span class="string">'&lt;html&gt;&lt;head&gt;'</span>,
			<span class="string">'&lt;meta http-equiv="refresh" content="1;url='</span> + mount + <span class="string">'"&gt;'</span>,
			<span class="string">'&lt;/head&gt;&lt;body&gt;'</span>,
			<span class="string">'&lt;h1&gt;Twitter authentication required.&lt;/h1&gt;'</span>,
			<span class="string">'&lt;/body&gt;&lt;/html&gt;'</span>
		].join(<span class="string">''</span>));
	};
}


<span class="comment">/*
 * CONVENIENCE FUNCTIONS (not API stable!)
 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Timeline resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.getHomeTimeline = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/home_timeline.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getMentions = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/mentions.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getRetweetedByMe = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/retweeted_by_me.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getRetweetedToMe = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/retweeted_to_me.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getRetweetsOfMe = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/retweets_of_me.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getUserTimeline = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/user_timeline.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getRetweetedToUser = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/retweeted_to_user.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getRetweetedByUser = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/retweeted_by_user.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Tweets resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.showStatus = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/show/'</span> + escape(id) + <span class="string">'.json'</span>;
	<span class="keyword">this</span>.get(url, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.getStatus
	= Twitter.prototype.showStatus;

Twitter.prototype.updateStatus = <span class="function"><span class="keyword">function</span><span class="params">(text, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> url = <span class="string">'/statuses/update.json'</span>;
	<span class="keyword">var</span> defaults = {
		status: text,
		include_entities: <span class="number">1</span>
	};
	params = merge(defaults, params);
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.destroyStatus = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/destroy/'</span> + escape(id) + <span class="string">'.json'</span>;
	<span class="keyword">this</span>.post(url, <span class="literal">null</span>, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.deleteStatus
	= Twitter.prototype.destroyStatus;

Twitter.prototype.retweetStatus = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/retweet/'</span> + escape(id) + <span class="string">'.json'</span>;
	<span class="keyword">this</span>.post(url, <span class="literal">null</span>, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getRetweets = <span class="function"><span class="keyword">function</span><span class="params">(id, params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/retweets/'</span> + escape(id) + <span class="string">'.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getRetweetedBy = <span class="function"><span class="keyword">function</span><span class="params">(id, params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/'</span> + escape(id) + <span class="string">'/retweeted_by.json'</span>;
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getRetweetedByIds = <span class="function"><span class="keyword">function</span><span class="params">(id, params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/'</span> + escape(id) + <span class="string">'/retweeted_by/ids.json'</span>;
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>User resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.showUser = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>FIXME: handle id-array and id-with-commas as lookupUser
 NOTE: params with commas b0rk between node-oauth and twitter
       <a href="https://github.com/ciaranj/node-oauth/issues/7">https://github.com/ciaranj/node-oauth/issues/7</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span> url = <span class="string">'/users/show.json'</span>;

	<span class="keyword">var</span> params = {};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		params.screen_name = id;
	<span class="keyword">else</span>
		params.user_id = id;

	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.lookupUser
	= Twitter.prototype.lookupUsers
	= Twitter.prototype.showUser;

Twitter.prototype.searchUser = <span class="function"><span class="keyword">function</span><span class="params">(q, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> url = <span class="string">'/users/search.json'</span>;
	params = merge(params, {q:q});
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.searchUsers
	= Twitter.prototype.searchUser;</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>FIXME: users/suggestions**</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.userProfileImage = <span class="function"><span class="keyword">function</span><span class="params">(id, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'string'</span>) {
		params = { size: params };
	}

	<span class="keyword">var</span> url = <span class="string">'/users/profile_image/'</span> + escape(id) + <span class="string">'.json?'</span> + querystring.stringify(params);</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Do our own request, so we can return the 302 location header</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span> request = <span class="keyword">this</span>.oauth.get(<span class="keyword">this</span>.options.rest_base + url,
		<span class="keyword">this</span>.options.access_token_key,
		<span class="keyword">this</span>.options.access_token_secret);
	request.on(<span class="string">'response'</span>, <span class="function"><span class="keyword">function</span><span class="params">(response)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>return the location or an HTTP error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		callback(response.headers.location || <span class="keyword">new</span> Error(<span class="string">'HTTP Error '</span>
			+ response.statusCode + <span class="string">': '</span>
			+ http.STATUS_CODES[response.statusCode]));
	});
	request.end();

	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>FIXME: statuses/friends, statuses/followers</p>
<p>Trends resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.getTrends = <span class="function"><span class="keyword">function</span><span class="params">(callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/trends.json'</span>;
	<span class="keyword">this</span>.get(url, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getCurrentTrends = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/trends/current.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getDailyTrends = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/trends/daily.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getWeeklyTrends = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/trends/weekly.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Local Trends resources</p>
<p>List resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.getLists = <span class="function"><span class="keyword">function</span><span class="params">(id, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> defaults = {key:<span class="string">'lists'</span>};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		defaults.screen_name = id;
	<span class="keyword">else</span>
		defaults.user_id = id;
	params = merge(defaults, params);

	<span class="keyword">var</span> url = <span class="string">'/lists.json'</span>;
	<span class="keyword">this</span>._getUsingCursor(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getListMemberships = <span class="function"><span class="keyword">function</span><span class="params">(id, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> defaults = {key:<span class="string">'lists'</span>};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		defaults.screen_name = id;
	<span class="keyword">else</span>
		defaults.user_id = id;
	params = merge(defaults, params);

	<span class="keyword">var</span> url = <span class="string">'/lists/memberships.json'</span>;
	<span class="keyword">this</span>._getUsingCursor(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getListSubscriptions = <span class="function"><span class="keyword">function</span><span class="params">(id, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> defaults = {key:<span class="string">'lists'</span>};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		defaults.screen_name = id;
	<span class="keyword">else</span>
		defaults.user_id = id;
	params = merge(defaults, params);

	<span class="keyword">var</span> url = <span class="string">'/lists/subscriptions.json'</span>;
	<span class="keyword">this</span>._getUsingCursor(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>FIXME: Uses deprecated Twitter lists API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.showList = <span class="function"><span class="keyword">function</span><span class="params">(screen_name, list_id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/'</span> + escape(screen_name) + <span class="string">'/lists/'</span> + escape(list_id) + <span class="string">'.json'</span>;
	<span class="keyword">this</span>.get(url, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>FIXME: Uses deprecated Twitter lists API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.getListTimeline = <span class="function"><span class="keyword">function</span><span class="params">(screen_name, list_id, params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/'</span> + escape(screen_name) + <span class="string">'/lists/'</span> + escape(list_id) + <span class="string">'/statuses.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.showListStatuses
	= Twitter.prototype.getListTimeline;</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>FIXME: Uses deprecated Twitter lists API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.createList = <span class="function"><span class="keyword">function</span><span class="params">(screen_name, list_name, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> url = <span class="string">'/'</span> + escape(screen_name) + <span class="string">'/lists.json'</span>;
	params = merge(params, {name:list_name});
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>FIXME: Uses deprecated Twitter lists API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.updateList = <span class="function"><span class="keyword">function</span><span class="params">(screen_name, list_id, params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/'</span> + escape(screen_name) + <span class="string">'/lists/'</span> + escape(list_id) + <span class="string">'.json'</span>;
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>FIXME: Uses deprecated Twitter lists API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.deleteList = <span class="function"><span class="keyword">function</span><span class="params">(screen_name, list_id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/'</span> + escape(screen_name) + <span class="string">'/lists/'</span> + escape(list_id) + <span class="string">'.json?_method=DELETE'</span>;
	<span class="keyword">this</span>.post(url, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.destroyList
	= Twitter.prototype.deleteList;</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>List Members resources</p>
<p>FIXME: Uses deprecated Twitter lists API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.getListMembers = <span class="function"><span class="keyword">function</span><span class="params">(screen_name, list_id, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> url = <span class="string">'/'</span> + escape(screen_name) + <span class="string">'/'</span> + escape(list_id) + <span class="string">'/members.json'</span>;
	params = merge(params, {key:<span class="string">'users'</span>});
	<span class="keyword">this</span>._getUsingCursor(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>FIXME: the rest of list members</p>
<p>List Subscribers resources</p>
<p>FIXME: Uses deprecated Twitter lists API</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.getListSubscribers = <span class="function"><span class="keyword">function</span><span class="params">(screen_name, list_id, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> url = <span class="string">'/'</span> + escape(screen_name) + <span class="string">'/'</span> + escape(list_id) + <span class="string">'/subscribers.json'</span>;
	params = merge(params, {key:<span class="string">'users'</span>});
	<span class="keyword">this</span>._getUsingCursor(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>FIXME: the rest of list subscribers</p>
<p>Direct Messages resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.getDirectMessages = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/direct_messages.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getDirectMessagesSent = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/direct_messages/sent.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.getSentDirectMessages
	= Twitter.prototype.getDirectMessagesSent;

Twitter.prototype.newDirectMessage = <span class="function"><span class="keyword">function</span><span class="params">(id, text, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> defaults = {
		text: text,
		include_entities: <span class="number">1</span>
	};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		defaults.screen_name = id;
	<span class="keyword">else</span>
		defaults.user_id = id;
	params = merge(defaults, params);

	<span class="keyword">var</span> url = <span class="string">'/direct_messages/new.json'</span>;
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.updateDirectMessage
	= Twitter.prototype.sendDirectMessage
	= Twitter.prototype.newDirectMessage;

Twitter.prototype.destroyDirectMessage = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/direct_messages/destroy/'</span> + escape(id) + <span class="string">'.json?_method=DELETE'</span>;
	<span class="keyword">this</span>.post(url, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.deleteDirectMessage
	= Twitter.prototype.destroyDirectMessage;</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Friendship resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.createFriendship = <span class="function"><span class="keyword">function</span><span class="params">(id, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> defaults = {
		include_entities: <span class="number">1</span>
	};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		defaults.screen_name = id;
	<span class="keyword">else</span>
		defaults.user_id = id;
	params = merge(defaults, params);

	<span class="keyword">var</span> url = <span class="string">'/friendships/create.json'</span>;
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.destroyFriendship = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'function'</span>) {
		callback = id;
		id = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> params = {
		include_entities: <span class="number">1</span>
	};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		params.screen_name = id;
	<span class="keyword">else</span>
		params.user_id = id;

	<span class="keyword">var</span> url = <span class="string">'/friendships/destroy.json?_method=DELETE'</span>;
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.deleteFriendship
	= Twitter.prototype.destroyFriendship;</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Only exposing friendships/show instead of friendships/exist</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.showFriendship = <span class="function"><span class="keyword">function</span><span class="params">(source, target, callback)</span> {</span>
	<span class="keyword">var</span> params = {};

	<span class="keyword">if</span> (<span class="keyword">typeof</span> source === <span class="string">'string'</span>)
		params.source_screen_name = source;
	<span class="keyword">else</span>
		params.source_id = source;

	<span class="keyword">if</span> (<span class="keyword">typeof</span> target === <span class="string">'string'</span>)
		params.target_screen_name = target;
	<span class="keyword">else</span>
		params.target_id = target;

	<span class="keyword">var</span> url = <span class="string">'/friendships/show.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.incomingFriendship = <span class="function"><span class="keyword">function</span><span class="params">(callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/friendships/incoming.json'</span>;
	<span class="keyword">this</span>._getUsingCursor(url, {key:<span class="string">'ids'</span>}, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.incomingFriendships
	= Twitter.prototype.incomingFriendship;

Twitter.prototype.outgoingFriendship = <span class="function"><span class="keyword">function</span><span class="params">(callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/friendships/outgoing.json'</span>;
	<span class="keyword">this</span>._getUsingCursor(url, {key:<span class="string">'ids'</span>}, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.outgoingFriendships
	= Twitter.prototype.outgoingFriendship;</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Friends and Followers resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.getFriendsIds = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'function'</span>) {
		callback = id;
		id = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> params = { key: <span class="string">'ids'</span> };
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		params.screen_name = id;
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'number'</span>)
		params.user_id = id;

	<span class="keyword">var</span> url = <span class="string">'/friends/ids.json'</span>;
	<span class="keyword">this</span>._getUsingCursor(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getFollowersIds = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'function'</span>) {
		callback = id;
		id = <span class="literal">null</span>;
	}

	<span class="keyword">var</span> params = { key: <span class="string">'ids'</span> };
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		params.screen_name = id;
	<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'number'</span>)
		params.user_id = id;

	<span class="keyword">var</span> url = <span class="string">'/followers/ids.json'</span>;
	<span class="keyword">this</span>._getUsingCursor(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Account resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.verifyCredentials = <span class="function"><span class="keyword">function</span><span class="params">(callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/account/verify_credentials.json'</span>;
	<span class="keyword">this</span>.get(url, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.rateLimitStatus = <span class="function"><span class="keyword">function</span><span class="params">(callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/account/rate_limit_status.json'</span>;
	<span class="keyword">this</span>.get(url, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.updateProfile = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>params: name, url, location, description</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">var</span> defaults = {
		include_entities: <span class="number">1</span>
	};
	params = merge(defaults, params);

	<span class="keyword">var</span> url = <span class="string">'/account/update_profile.json'</span>;
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>FIXME: Account resources section not complete</p>
<p>Favorites resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.getFavorites = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/favorites.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.createFavorite = <span class="function"><span class="keyword">function</span><span class="params">(id, params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/favorites/create/'</span> + escape(id) + <span class="string">'.json'</span>;
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.favoriteStatus
	= Twitter.prototype.createFavorite;

Twitter.prototype.destroyFavorite = <span class="function"><span class="keyword">function</span><span class="params">(id, params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/favorites/destroy/'</span> + escape(id) + <span class="string">'.json'</span>;
	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.deleteFavorite
	= Twitter.prototype.destroyFavorite;</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Notification resources</p>
<p>Block resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.createBlock = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/blocks/create.json'</span>;

	<span class="keyword">var</span> params = {};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		params.screen_name = id;
	<span class="keyword">else</span>
		params.user_id = id;

	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.blockUser
	= Twitter.prototype.createBlock;

Twitter.prototype.destroyBlock = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/blocks/destroy.json'</span>;

	<span class="keyword">var</span> params = {};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		params.screen_name = id;
	<span class="keyword">else</span>
		params.user_id = id;

	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.unblockUser
	= Twitter.prototype.destroyBlock;

Twitter.prototype.blockExists = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/blocks/exists.json'</span>;

	<span class="keyword">var</span> params = {};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		params.screen_name = id;
	<span class="keyword">else</span>
		params.user_id = id;

	<span class="keyword">this</span>.get(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.isBlocked
	= Twitter.prototype.blockExists;</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>FIXME: blocking section not complete (blocks/blocking + blocks/blocking/ids)</p>
<p>Spam Reporting resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.reportSpam = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/report_spam.json'</span>;

	<span class="keyword">var</span> params = {};
	<span class="keyword">if</span> (<span class="keyword">typeof</span> id === <span class="string">'string'</span>)
		params.screen_name = id;
	<span class="keyword">else</span>
		params.user_id = id;

	<span class="keyword">this</span>.post(url, params, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Saved Searches resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.savedSearches = <span class="function"><span class="keyword">function</span><span class="params">(callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/saved_searches.json'</span>;
	<span class="keyword">this</span>.get(url, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.showSavedSearch = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/saved_searches/'</span> + escape(id) + <span class="string">'.json'</span>;
	<span class="keyword">this</span>.get(url, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.createSavedSearch = <span class="function"><span class="keyword">function</span><span class="params">(query, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/saved_searches/create.json'</span>;
	<span class="keyword">this</span>.post(url, {query: query}, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.newSavedSearch =
	Twitter.prototype.createSavedSearch;

Twitter.prototype.destroySavedSearch = <span class="function"><span class="keyword">function</span><span class="params">(id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/saved_searches/destroy/'</span> + escape(id) + <span class="string">'.json?_method=DELETE'</span>;
	<span class="keyword">this</span>.post(url, <span class="literal">null</span>, <span class="literal">null</span>, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}
Twitter.prototype.deleteSavedSearch =
	Twitter.prototype.destroySavedSearch;</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>OAuth resources</p>
<p>Geo resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.geoSearch = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/geo/search.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.geoSimilarPlaces = <span class="function"><span class="keyword">function</span><span class="params">(lat, lng, name, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = {};
	} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> params !== <span class="string">'object'</span>) {
		params = {};
	}

	<span class="keyword">if</span> (<span class="keyword">typeof</span> lat !== <span class="string">'number'</span> || <span class="keyword">typeof</span> lng !== <span class="string">'number'</span> || !name) {
		callback(<span class="keyword">new</span> Error(<span class="string">'FAIL: You must specify latitude, longitude (as numbers) and name.'</span>));
	}

	<span class="keyword">var</span> url = <span class="string">'/geo/similar_places.json'</span>;
	params.lat = lat;
	params.long = lng;
	params.name = name;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.geoReverseGeocode = <span class="function"><span class="keyword">function</span><span class="params">(lat, lng, params, callback)</span> {</span>
	<span class="keyword">if</span> (<span class="keyword">typeof</span> params === <span class="string">'function'</span>) {
		callback = params;
		params = {};
	} <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> params !== <span class="string">'object'</span>) {
		params = {};
	}

	<span class="keyword">if</span> (<span class="keyword">typeof</span> lat !== <span class="string">'number'</span> || <span class="keyword">typeof</span> lng !== <span class="string">'number'</span>) {
		callback(<span class="keyword">new</span> Error(<span class="string">'FAIL: You must specify latitude and longitude as numbers.'</span>));
	}

	<span class="keyword">var</span> url = <span class="string">'/geo/reverse_geocode.json'</span>;
	params.lat = lat;
	params.long = lng;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.geoGetPlace = <span class="function"><span class="keyword">function</span><span class="params">(place_id, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/geo/id/'</span> + escape(place_id) + <span class="string">'.json'</span>;
	<span class="keyword">this</span>.get(url, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Legal resources</p>
<p>Help resources</p>
<p>Streamed Tweets resources</p>
<p>Search resources</p>
<p>Deprecated resources</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Twitter.prototype.getPublicTimeline = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/public_timeline.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype.getFriendsTimeline = <span class="function"><span class="keyword">function</span><span class="params">(params, callback)</span> {</span>
	<span class="keyword">var</span> url = <span class="string">'/statuses/friends_timeline.json'</span>;
	<span class="keyword">this</span>.get(url, params, callback);
	<span class="keyword">return</span> <span class="keyword">this</span>;
}


<span class="comment">/*
 * INTERNAL UTILITY FUNCTIONS
 */</span>

Twitter.prototype._getUsingCursor = <span class="function"><span class="keyword">function</span><span class="params">(url, params, callback)</span> {</span>
	<span class="keyword">var</span> self = <span class="keyword">this</span>,
		params = params || {},
		key = params.key || <span class="literal">null</span>,
		result = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>if we don&#39;t have a key to fetch, we&#39;re screwed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> (!key)
		callback(<span class="keyword">new</span> Error(<span class="string">'FAIL: Results key must be provided to _getUsingCursor().'</span>));
	<span class="keyword">delete</span> params.key;</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>kick off the first request, using cursor -1</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	params = merge(params, {cursor:-<span class="number">1</span>});
	<span class="keyword">this</span>.get(url, params, fetch);

	<span class="function"><span class="keyword">function</span> <span class="title">fetch</span><span class="params">(data)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>FIXME: what if data[key] is not a list?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="keyword">if</span> (data[key]) result = result.concat(data[key]);

		<span class="keyword">if</span> (data.next_cursor_str === <span class="string">'0'</span>) {
			callback(result);
		} <span class="keyword">else</span> {
			params.cursor = data.next_cursor_str;
			self.get(url, params, fetch);
		}
	}

	<span class="keyword">return</span> <span class="keyword">this</span>;
}

Twitter.prototype._readCookie = <span class="function"><span class="keyword">function</span><span class="params">(cookies)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>parse the auth cookie</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">try</span> {
		<span class="keyword">var</span> twauth = JSON.parse(cookies.get(<span class="keyword">this</span>.options.cookie));
	} <span class="keyword">catch</span> (error) {
		<span class="keyword">var</span> twauth = <span class="literal">null</span>;
	}
	<span class="keyword">return</span> twauth;
}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
